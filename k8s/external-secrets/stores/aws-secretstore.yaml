# AWS Secrets Manager SecretStore
# Prerequisites:
# 1. Create AWS credentials secret:
#    kubectl create secret generic aws-credentials \
#      --from-literal=access-key-id=YOUR_ACCESS_KEY \
#      --from-literal=secret-access-key=YOUR_SECRET_KEY \
#      -n default
#
# 2. Store secrets in AWS Secrets Manager with keys like:
#    - portfolio/bookmarked/database-url
#    - portfolio/bookmarked/jwt-secret
#    - portfolio/code-talk/database-url
#    - portfolio/code-talk/redis-url
#    - portfolio/code-talk/jwt-secret
#    etc.

apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: aws-secretstore
  namespace: default
spec:
  provider:
    aws:
      service: SecretsManager
      region: us-east-1  # Change to your region
      auth:
        secretRef:
          accessKeyID:
            name: aws-credentials
            key: access-key-id
          secretAccessKey:
            name: aws-credentials
            key: secret-access-key

---
# Alternative: Use IAM Role for Service Account (IRSA) - No credentials needed in cluster
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: aws-secretstore-irsa
  namespace: default
spec:
  provider:
    aws:
      service: SecretsManager
      region: us-east-1
      auth:
        jwt:
          serviceAccountRef:
            name: external-secrets-sa  # ServiceAccount with IAM role annotation
