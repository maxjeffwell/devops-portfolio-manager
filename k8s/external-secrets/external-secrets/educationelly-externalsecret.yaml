# EducationELLy Application External Secret
# EducationELLy uses MongoDB Atlas
# Prerequisites:
# 1. Create and apply a SecretStore (e.g., aws-secretstore.yaml or mongodb-atlas-secretstore.yaml)
# 2. Store secrets in external store:
#    - portfolio/educationelly/mongodb-uri
#    - portfolio/educationelly/jwt-secret
# 3. Apply this ExternalSecret: kubectl apply -f educationelly-externalsecret.yaml

apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: educationelly-externalsecret
  namespace: default
spec:
  refreshInterval: 1h

  secretStoreRef:
    name: aws-secretstore  # Change to your SecretStore name
    kind: SecretStore

  target:
    name: educationelly-secret
    creationPolicy: Owner
    template:
      type: Opaque
      metadata:
        labels:
          app: educationelly
      data:
        MONGODB_URI: "{{ .mongodbUri }}"
        JWT_SECRET: "{{ .jwtSecret }}"

  data:
    - secretKey: mongodbUri
      remoteRef:
        key: portfolio/educationelly/mongodb-uri
    - secretKey: jwtSecret
      remoteRef:
        key: portfolio/educationelly/jwt-secret
