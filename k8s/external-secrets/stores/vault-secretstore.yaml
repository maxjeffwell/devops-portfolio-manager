# HashiCorp Vault SecretStore
# Prerequisites:
# 1. Deploy HashiCorp Vault or use HCP Vault
# 2. Enable Kubernetes auth in Vault:
#    vault auth enable kubernetes
#    vault write auth/kubernetes/config \
#      kubernetes_host="https://kubernetes.default.svc"
# 3. Create policy and role in Vault
# 4. Store secrets at paths like:
#    - secret/data/portfolio/bookmarked/database-url
#    - secret/data/portfolio/bookmarked/jwt-secret
#    etc.

apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-secretstore
  namespace: default
spec:
  provider:
    vault:
      server: "https://vault.example.com:8200"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "external-secrets-role"
          serviceAccountRef:
            name: external-secrets-sa

---
# Alternative: Token-based authentication
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-secretstore-token
  namespace: default
spec:
  provider:
    vault:
      server: "https://vault.example.com:8200"
      path: "secret"
      version: "v2"
      auth:
        tokenSecretRef:
          name: vault-token
          key: token

---
# Create vault token secret
# kubectl create secret generic vault-token \
#   --from-literal=token=YOUR_VAULT_TOKEN \
#   -n default
